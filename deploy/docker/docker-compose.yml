services:
  core-api:
    image: ${REGISTRY:-foundationallm}/core-api:${TAG:-latest}
    profiles: ["all", "core"]
    build:
      context: ../../src
      dockerfile: ./dotnet/CoreAPI/Dockerfile
    ports:
    - "80:80"
    environment:
      DOTNET_URLS: http://+:80
      ASPNETCORE_ENVIRONMENT: Production
      AllowedHosts: '*'
      Logging__Loglevel__Default: 'Debug'
      Logging__Loglevel__Microsoft__AspNetCore: 'Debug'

  core-job:
    image: ${REGISTRY:-foundationallm}/core-job:${TAG:-latest}
    profiles: ["all", "core"]
    build:
      context: ../../src
      dockerfile: ./dotnet/CoreWorker/Dockerfile
    environment:
      ASPNETCORE_ENVIRONMENT: Production
      Logging__Loglevel__Default: 'Debug'
      Logging__Loglevel__Microsoft__AspNetCore: 'Debug'

  agent-factory-api:
    image: ${REGISTRY:-foundationallm}/agent-factory-api:${TAG:-latest}
    profiles: ["all", "agent-factory"]
    build:
      context: ../../src/
      dockerfile: ./dotnet/AgentFactoryAPI/Dockerfile
    ports:
    - "80:80"
    environment:
      DOTNET_URLS: http://+:80
      ASPNETCORE_ENVIRONMENT: Production
      AllowedHosts: '*'
      Logging__Loglevel__Default: 'Debug'
      Logging__Loglevel__Microsoft__AspNetCore: 'Debug'

  gatekeeper-api:
    image: ${REGISTRY:-foundationallm}/gatekeeper-api:${TAG:-latest}
    profiles: ["all", "gatekeeper-factory"]
    build:
      context: ../../src/
      dockerfile: ./dotnet/GatekeeperAPI/Dockerfile
    ports:
    - "80:80"
    environment:
      DOTNET_URLS: http://+:80
      ASPNETCORE_ENVIRONMENT: Production
      AllowedHosts: '*'
      Logging__Loglevel__Default: 'Debug'
      Logging__Loglevel__Microsoft__AspNetCore: 'Debug'

  semantic-kernel-api:
    image: ${REGISTRY:-foundationallm}/semantic-kernel-api:${TAG:-latest}
    profiles: ["all", "semantic-kernel"]
    build:
      context: ../../src/
      dockerfile: ./dotnet/SemanticKernelAPI/Dockerfile
    ports:
    - "80:80"
    environment:
      DOTNET_URLS: http://+:80
      ASPNETCORE_ENVIRONMENT: Production
      AllowedHosts: '*'
      Logging__Loglevel__Default: 'Debug'
      Logging__Loglevel__Microsoft__AspNetCore: 'Debug'

  langchain-api:
    image: ${REGISTRY:-foundationallm}/langchain-api:${TAG:-latest}
    profiles: ["all", "langchain-api"]
    build:
      context: ../../src/python
      dockerfile: ./LangChainAPI/Dockerfile
    ports:
    - "8081:80"

  agent-hub-api:
    image: ${REGISTRY:-foundationallm}/agent-hub-api:${TAG:-latest}
    profiles: ["all", "agent-hub-api"]
    build:
      context: ../../src/python
      dockerfile: ./AgentHubAPI/Dockerfile
    ports:
    - "8081:80"

  data-source-hub-api:
    image: ${REGISTRY:-foundationallm}/data-source-hub-api:${TAG:-latest}
    profiles: ["all", "data-source-hub-api"]
    build:
      context: ../../src/python
      dockerfile: ./DataSourceHubAPI/Dockerfile
    ports:
    - "8081:80"

  prompt-hub-api:
    image: ${REGISTRY:-foundationallm}/prompt-hub-api:${TAG:-latest}
    profiles: ["all", "prompt-hub-api"]
    build:
      context: ../../src/python
      dockerfile: ./PromptHubAPI/Dockerfile
    ports:
    - "8081:80"

  chat-ui:
    image: ${REGISTRY:-foundationallm}/chat-ui:${TAG:-latest}
    profiles: ["all", "core", "chat"]
    build:
      context: ../../src/ui/UserPortal
      dockerfile: ./Dockerfile
    ports:
    - "8080:80"
    environment:
      DOTNET_URLS: http://+:80
      ASPNETCORE_ENVIRONMENT: Production
      AllowedHosts: '*'
      DetailedErrors: 'true'
      Logging__Loglevel__Default: 'Debug'
      Logging__Loglevel__Microsoft__AspNetCore: 'Debug'

  jaeger-telemetry:
    image: ${REGISTRY:-foundationallm}/jaegertracing:${TAG:-latest}
    profiles: ["all", "jaeger"]
    build:
      context: ../../src/images
      dockerfile: ./jaeger/Dockerfile
    ports:
    - "8081:80"